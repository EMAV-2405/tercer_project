{% extends 'base.html' %}
{% block content %}
<div style="padding: 40px; max-width: 900px; margin: 0 auto;">
    
    <div style="display: flex; align-items: center; margin-bottom: 30px; gap: 20px;">
        <div style="background: #003478; color: white; width: 80px; height: 80px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 35px;">
            {{ user.username|slice:":1"|upper }}
        </div>
        <div>
            <h1 style="margin: 0; color: #333;">{{ user.first_name }} {{ user.last_name }}</h1>
            <p style="color: #777; margin: 0;">Usuario: {{ user.username }} | {{ user.email }}</p>
        </div>
    </div>

    <div style="display: flex; gap: 40px; flex-wrap: wrap;">
        
        <!-- COLUMNA 1: Tarjetas Guardadas -->
        <div style="flex: 1; min-width: 300px;">
            <h3 style="color: #003478; border-bottom: 2px solid #ddd; padding-bottom: 10px;">ðŸ’³ MÃ©todos de Pago Registrados</h3>
            {% if tarjetas %}
                {% for t in tarjetas %}
                <div style="background: linear-gradient(135deg, #003478, #005bb5); color: white; padding: 20px; border-radius: 10px; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.2);">
                    <div style="font-size: 12px; opacity: 0.8;">FORD SECURE PAY</div>
                    <div style="font-size: 22px; letter-spacing: 2px; margin: 15px 0;">**** **** **** {{ t.referencia|slice:"-4:" }}</div>
                    <div style="display: flex; justify-content: space-between; font-size: 14px;">
                        <span>TITULAR</span>
                        <span>{{ user.first_name|upper }}</span>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <p style="color: #777; font-style: italic;">No tienes tarjetas registradas aÃºn.</p>
            {% endif %}
        </div>

        <!-- COLUMNA 2: Historial de Compras -->
        <div style="flex: 2; min-width: 300px;">
            <h3 style="color: #003478; border-bottom: 2px solid #ddd; padding-bottom: 10px;">ðŸ•’ Historial de Compras</h3>
            <table style="width: 100%; border-collapse: collapse; background: white;">
                <tr style="background: #f4f4f4; color: #555;">
                    <th style="padding: 10px; text-align: left;">Fecha</th>
                    <th style="padding: 10px; text-align: left;">MÃ©todo</th>
                    <th style="padding: 10px; text-align: right;">Total</th>
                    <th style="padding: 10px; text-align: center;">Estado</th>
                </tr>
                {% for compra in historial %}
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 10px;">{{ compra.fecha|date:"d M Y" }}</td>
                    <td style="padding: 10px;">
                        {% if compra.tipo_pago == 'tarjeta' %}ðŸ’³ Tarjeta{% else %}ðŸ’µ Efectivo{% endif %}
                    </td>
                    <td style="padding: 10px; text-align: right; font-weight: bold;">${{ compra.monto }}</td>
                    <td style="padding: 10px; text-align: center;">
                        <span style="background: #d4edda; color: #155724; padding: 3px 8px; border-radius: 10px; font-size: 12px;">Completado</span>
                    </td>
                </tr>
                {% empty %}
                <tr><td colspan="4" style="padding: 20px; text-align: center;">AÃºn no has realizado compras.</td></tr>
                {% endfor %}
            </table>
        </div>
    </div>
</div>
{% endblock %}